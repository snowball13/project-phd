
\chapter{Introduction}

Univariate orthogonal polynomials (hereon also referred to as OPs) have been extensively involved in the development of multiple fields of computational and applied mathematics. For example, univariate OPs have been used to derive spectral methods to numerically solve one-dimensional differential equations (see e.g. \cite{trefethen2000spectral, boyd2001chebyshev, mason2002chebyshev, shen2011spectral, olver2013fast} \bstodo{add more from the references in these papers}). While there are many famous examples of univariate OPs -- such as the Jacobi polynomials, the Legendre polynomials and the Chebyshev polynomials but to name a few of the classical families \cite[Section 18.3]{DLMF} -- the area of multivariate orthogonal polynomials has a smaller array of research. 

One could say this is surprising, given that there is a long history of around 150 years associated with multivariate OPs, beginning with Hermite first presenting the multivariate Hermite polynomials in 1865 \cite{appel1926fonctions, ismail2017review}. Zernike polynomials \cite{zernike1934diffraction} were first introduced in 1934, as another example, that are a group of bivariate polynomials orthogonal on a unit circle. Koornwinder in 1975 described a method for constructing two-variable OPs from univariate OPs \cite{koornwinder1975two}. However, few books have been published over the years on the topic of multivariate orthogonal polynomials \cite{dunkl2014orthogonal}.

This branch of mathematics has an encouraging future though, not least as a basis for sparse spectral methods for solving partial differential equations (PDEs) on multidimensional domains. Spectral methods have been established on the triangle \cite{olver2019triangle} using OPs inspired by the Koornwinder approach for defining them, and on the disk \cite{vasil2016tensor} using Zernike polynomials. Applications include solving Volterra integral equations \cite{gutleb2020sparse}. 

There are various interpretations of what a \enquote{spectral method} is. It could be described as one that achieves spectral convergence of its solutions, or one that uses eigenfunctions as basis functions, or one that uses OPs as basis polynomials \cite{}\bstodo{cite these as interpretations}. It is the latter that we refer to for our purposes as a spectral method. By utilising OPs as basis functions, we can develop sparse spectral methods (SSMs), meaning that the naturally sparse relationships between the basis OPs lead to sparse operator matrices that represent the differential operations in the equation to solve. Sparse spectral methods for one dimensional problems have been shown to lead to \enquote{almost banded} matrices \cite{olver2013fast}. 

In this thesis we expand upon this knowledge by providing frameworks for similar sparse spectral methods for solving PDEs on other multidimensional domains (notably including the disk-slice and trapezium in 2D, and the spherical cap surface in 3D) that also yield matrices that are what is defined as \enquote{banded-block-banded}. We take inspiration from the work established for the triangle \cite{olver2019triangle} and the unit disk \cite{vasil2016tensor}, which can  be seen as special cases of the disk-slice and trapezium in the framework we present here. The spherical cap work serves to lay a foundation for using spherical caps and spherical bands as elements in a spectral element method for solving PDEs on the whole sphere, as an alternative to the Spherical Harmonic transform approach that the European Centre for Medium-range Weather Forecasts (ECMWF) use in their weather and climate model \cite{cheong2006dynamical}. 

Spherical Harmonics are of course a long-established and famous group of functions defined on the surface of a sphere with certain useful properties (for example, they are orthogonal to each other on the unit sphere and form a basis for expanding functions defined on the sphere) and as a result are widely used in many fields including computer graphics (e.g. \cite{moon2008efficient, sloan2013efficient}), astrophysics (e.g. \cite{vasil2019tensor}), quantum theory (e.g. \cite{varshalovich1988quantum}), geosciences (e.g. \cite{hollerbach2013parity}) and meteorology (e.g. \cite{evans1998spherical, rubinstein2015scalar}) \bstodo{cite applications of SHs}. Notably, they are also used as basis functions for the spectral transform method that makes up part of the model in the Integrated Forecasting System (IFS), which is used by ECMWF for their forecasts \cite{wedi2013fast}. While the whole sphere spectral method using the Spherical Harmonics has been successful for numerous years \cite{williamson2007evolution}, there is a drawback in the parallel scalability bottleneck that arises from the global spectral transform, which is expected to inhibit future performance of the IFS \cite{ecmwf2020scalability, wedi2013fast, diamantakisecmwf}. 

Many implementations of an algorithm to compute the spectral transform (or spherical harmonic transform) exist (see e.g. \cite{slevinsky2019fast, suda2002fast}). For the IFS, the spherical harmonic transform in fact uses two transforms -- a Fourier transform (using the well-established Fast Fourier Transform (FFT) \cite{cooley1965algorithm}) in the longitudinal direction and a Legendre transform in the latitudinal direction -- and it is the Legendre transform that has been identified as inhibiting future performance due to its computational cost. While a Fast Legendre Transform (FLT) \cite{wedi2013fast} has been incorporated into the model, along with new grid types \cite{malardel2016new}, to help to extend the lifespan of the spectral method for numerical weather prediction (NWP), it may not be sufficient for certain desired cases and resolutions \cite{diamantakisecmwf}. 

The motivation for this project was to help address this problem while still utilising a spectral approach. More precisely, we aim to develop a sparse spectral method for solving PDEs on the spherical cap as a surface in 3D, with a simple extension to a spherical band. Together, these frameworks can be pieced together to create a spectral element method for the whole sphere, or further developed to investigate spectral methods on other spherical subdomains. This, however, is future work beyond the scope of this thesis. By spectral element method, we mean a finite element method (FEM) that uses high degree basis polynomials for its elements (this could also be referred to as a $p$-FEM with large $p$). In other words, we can use our spectral methods developed for the spherical band and cap elements as part of a finite element framework. By using this approach, one would be able to avoid having to complete the global spectral transform (in particular, the global Legendre transform) and instead be able to simply apply the local element transforms in parallel. Moreover, by still using a spectral approach, one can maintain the high accuracy and excellent error properties that such methods bring.

There are also potential applications in physics too where solving equations on the sphere and working in spherical geometries is also desirable (e.g. \cite{beyer2014numerical, varshalovich1988quantum, slevinsky2018spectral})\bstodo{cite more, see p2 of Vasil and the references}, particularly in astrophysics \cite{vasil2019tensor, reinecke2013libsharp}.

Recently, a method for computing tensor fields in spherical coordinates using Jacobi polynomials has been proposed \cite{vasil2019tensor}. In this work the authors present the method for both the surface of the unit sphere and the three-dimensional generalisation of the unit ball. Their method involves using a spectral basis to represent functions too, choosing for the angular part of the basis to be the spin-weighted spherical harmonics (of which the spherical harmonics are a special case, with spin $0$) in spherical coordinates. By using these as their basis functions, they are able to derive sparse relations for the Laplacian operator, as well as for multiplication of the basis by $\cosphi$ and $\sinphi$ (where $\varphi$ is the polar angle from the $z$ axis in cartesian coordinates) which lead to operators for operations with angular dependencies involving these. 

On the other hand, we aim to propose a strictly orthogonal \textit{polynomial} basis, and derive sparse operators for multiplication by the cartesian coordinate axes, which can in turn lead to operators for multiplication by trigonometric functions too. By utilising orthogonal polynomials, we can develop a sparse spectral method on subdomains of the sphere surface (e.g. the spherical cap) using our knowledge of other geometries and methods involving OPs developed for them.

The structure of this thesis is as follows.

Chapter 2 of this thesis provides an introduction to sparse spectral methods via the Spherical Harmonics on the whole sphere surface. Here, we think of the Spherical Harmonics in a non-traditional way and write them as a group of multidimensional orthogonal polynomials in $(x,y,z)$ as opposed to functions of spherical coordinates. We present an OP framework for how the Spherical Harmonics can be used to expand functions defined on the sphere as multidimensional polynomials in $x, y, z$, and how differential operators can be applied as banded-block-banded matrix operators to coefficient vectors for a function's expansion. Further, we demonstrate how the Vector Spherical Harmonics can be used as an orthogonal basis for vector valued functions lying in the tangent space of the sphere, and thus how one can additionally derive gradient and divergence operators.

In Chapter 3 we move on to working in 2D, where in recent years sparse spectral methods for solving PDEs have been derived using hierarchies of classical orthogonal polynomials on intervals, disks, and triangles. Presenting a new framework for choosing a suitable orthogonal polynomial basis for more general 2D domains defined via an algebraic curve as a boundary, this work builds on the observation that sparsity is guaranteed due to this definition of the boundary, and that the entries of partial differential operators can be determined using formulae in terms of (non-classical) univariate orthogonal polynomials, which we define. Triangles and the full disk are then special cases of our framework, which we formalise for the disk-slice and trapezium cases.

With a greater knowledge base in our quiver, we can adapt the techniques learnt from the founding of the disk-slice formulation to surfaces in 3D in Chapter 4. Using the same family of (non-classical) 1D OPs, we present a suitable orthogonal polynomial basis for the spherical cap, a subdomain of the surface of a unit sphere, complete with sparse differential operators. A relatively simple adaption permits this framework to be extended to a spherical band. From here, a spectral element method could be devised for the whole sphere using the aforementioned as elements.

Finally, we summarise the work we have presented and detail avenues for future directions that one could take it in Chapter 5.
