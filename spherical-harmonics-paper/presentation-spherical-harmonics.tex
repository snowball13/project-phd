\documentclass[10pt]{beamer}

% \usepackage{beamerthemesplit} // Activate for custom appearance

\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent

\usepackage{natbib}
\usepackage{url}
%\bibliographystyle{elsarticle-harv}
\bibliographystyle{plain}

\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex	
\usepackage{media9}

	
\usepackage{caption}
\usepackage{subcaption}
% \captionsetup[figure]{font=scriptsize, labelfont=scriptsize}
\usepackage{float}
\graphicspath{ {../sphere/plots} }
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage{bm}

\usetheme{Madrid}


\usepackage{mleftright}
\usepackage{todonotes}
\newcommand{\sotodo}{\todo[color=green]}
\newcommand{\sotodoinline}{\todo[color=green,inline=true]}

\newcommand{\half}{\frac{1}{2}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\No}{\mathbb{N}_0}
\newcommand{\Ylm}{Y^m_l}
\newcommand{\Ylmfull}{Y^m_l(\theta,\varphi)}
\newcommand{\Plm}{P^m_l}
\newcommand{\costheta}{\cos\theta}
\newcommand{\sintheta}{\sin\theta}
\newcommand{\cosphi}{\cos\varphi}
\newcommand{\sinphi}{\sin\varphi}
\newcommand{\eimphi}{e^{im\varphi}}
\newcommand{\alphalm}{\alpha^m_l}
\newcommand{\clm}{c^m_l}
\newcommand{\ctilde}{\tilde{c}^m_l}
\newcommand{\ctildemod}{\tilde{c}^{|m|}_l}
\newcommand{\chat}{\hat{c}^m_l}
\newcommand{\chatmod}{\hat{c}^{|m|}_l}
\newcommand{\ddx}{\frac{\mathrm{d}}{\mathrm{d}x}}
\newcommand{\dmdxm}{\frac{\mathrm{d}^m}{\mathrm{d}x^m}}

\newcommand{\Atilde}{\tilde{A}_{l,m}}
\newcommand{\Btilde}{\tilde{B}_{l,m}}
\newcommand{\Dtilde}{\tilde{D}_{l,m}}
\newcommand{\Etilde}{\tilde{E}_{l,m}}
\newcommand{\Ftilde}{\tilde{F}_{l,m}}
\newcommand{\Gtilde}{\tilde{G}_{l,m}}
\newcommand{\Alm}{A_{l,m}}
\newcommand{\Blm}{B_{l,m}}
\newcommand{\Dlm}{D_{l,m}}
\newcommand{\Elm}{E_{l,m}}
\newcommand{\Flm}{F_{l,m}}
\newcommand{\Glm}{G_{l,m}}

\newcommand{\xione}{\xi^{(1)}_{n, \lambda}}
\newcommand{\xitwo}{\xi^{(2)}_{n, \lambda}}
\newcommand{\xithree}{\xi^{(3)}_{n, \lambda}}
\newcommand{\xifour}{\xi^{(4)}_{n, \lambda}}

\newcommand{\bigP}{\mathbb{P}}
\newcommand{\Pl}{\mathbb{P}_l}
\newcommand{\gradP}{T\mathbb{P}}
\newcommand{\gradPl}{T\mathbb{P}_l}
\newcommand{\gradY}{\nabla Y}
\newcommand{\gradYlm}{\nabla Y^m_l}
\newcommand{\gradpY}{\nabla^\perp Y}
\newcommand{\gradpYlm}{\nabla^\perp Y^m_l}

\newcommand{\Dlt}{D^T_l}

\newcommand{\curlyy}{\bm{\mathcal{Y}}}
\newcommand{\blone}{\beta_{l, 1}}
\newcommand{\blzero}{\beta_{l, 0}}
\newcommand{\blmone}{\beta_{l, -1}}
\newcommand{\chivec}{\bm{\chi}_{1,m_s}}
\newcommand{\cgcoeff}{\mathcal{C}}

\newcommand{\alm}{a_{l,m}}
\newcommand{\blm}{b_{l,m}}
\newcommand{\dlm}{d_{l,m}}
\newcommand{\elm}{e_{l,m}}
\newcommand{\flm}{f_{l,m}}
\newcommand{\glm}{g_{l,m}}
\newcommand{\hlm}{h_{l,m}}
\newcommand{\jlm}{j_{l,m}}
\newcommand{\klm}{k_{l,m}}
\newcommand{\almperp}{a_{l,m}^\perp}
\newcommand{\blmperp}{b_{l,m}^\perp}
\newcommand{\dlmperp}{d_{l,m}^\perp}
\newcommand{\elmperp}{e_{l,m}^\perp}
\newcommand{\flmperp}{f_{l,m}^\perp}
\newcommand{\glmperp}{g_{l,m}^\perp}
\newcommand{\hlmperp}{h_{l,m}^\perp}
\newcommand{\jlmperp}{j_{l,m}^\perp}
\newcommand{\klmperp}{k_{l,m}^\perp}

\newcommand{\unitvec}{\hat{\bm{k}}}



\title{Spherical Harmonics and Vector Spherical Harmonics as Orthogonal Polynomials}
\author{Ben Snowball}
\date{\today}

\begin{document}

\frame{\titlepage}

\section[Outline]{}
\frame{\tableofcontents}
\section{Introduction}
\subsection{Spherical Harmonics (SHs) as orthogonal polynomials on the sphere in Cartesian coordinates}
\section{Surface of the sphere}
\subsection{Jacobi operators for multiplication of SHs by x, y, z}
\subsection{Recurrence relation and function evaluation}
\section{Tangent space}
\subsection{Spin-1 tensor spherical harmonics}
\subsection{Jacobi operators for multiplication of vector SHs by x, y, z}
\subsection{Recurrence relation and function evaluation}
\section{Example}
\subsection{Linearised SWE}
\section{Summary and Outlook}
\subsection{The circle arc}


\frame
{
  \frametitle{On the Unit Interval (1D)}

On the unit interval, \([-1,1]\), we note that there is a hierarchy of orthogonal polynomials (OPs) in the sense that
\begin{align}
& \ddx P^{(a,b)}_l (x) = \text{const.} \times P^{(a+1,b+1)}_{l-1}(x) \\
\implies & \dmdxm P_l(x) = \text{const.} \times P^{(m,m)}_{l-m}(x)
\end{align}
where \(P^{(a,b)}_l (x)\) is the degree \(l\) Jacobi polynomial, orthogonal with weight \(w(x) = (1-x)^a(1+x)^b\), and \(P_l(x) := P^{(0,0)}_l (x)\) is the Legendre polynomial of degree \(l\).

}

\frame
{
  \frametitle{On the Unit Interval (1D)}

Further, we can define associated Legendre polynomials that are also orthogonal:
\begin{align}
\Plm(x) &:= (-1)^m (1-x^2)^\frac{m}{2} \dmdxm P_l(x) = \chat (1-x^2)^\frac{m}{2} P^{(m,m)}_{l-m}(x) \\
P^{-m}_l(x) &:= \ctilde \Plm(x),
\end{align}
for \(m = 0,1,2,\ldots\) where
\begin{align}
\chat &:= \frac{\Gamma(l+m+1)}{(-2)^m\Gamma(l+1)} \\
\ctilde &:= \frac{(-1)^m\Gamma(l-m+1)}{\Gamma(l+m+1)}
\end{align}
using the gamma function \(\Gamma(n) := (n-1)!\) for \(n \in \N\).

}

\frame
{
    \frametitle{Spherical Harmonics as OPs of three variables}

Let \((x,y,z)\) be a point on the unit sphere such that \(x^2+y^2+z^2 = 1\). Let \(\theta, \varphi\) denote the angles such that
\begin{align}
x &= \sintheta \cosphi \\
y &= \sintheta \sinphi \\
z &= \costheta.
\end{align}
Further, define
\begin{align}
\clm := \Bigg(\frac{(2l+1)\Gamma(l-m+1)}{4\pi\Gamma(l+m+1)}\Bigg)^\frac{1}{2},
\end{align}
and
\begin{align}
\alphalm := \begin{cases} 
		\clm \chatmod \quad \quad \quad \text{if } m \ge 0 \\
		\clm \chatmod \ctildemod \quad \text{if } m < 0
	   \end{cases}.
\end{align}

}

\frame
{
    \frametitle{Spherical Harmonics as OPs of three variables}

\begin{itemize}

\item We can the define the spherical harmonics, orthogonal on the unit sphere as \cite{DLMFSphericalandSpheroidalHarmonics, DLMFFerrers, DLMFAssociatedLegendre}:
\begin{align}
\Ylmfull &:= \clm \eimphi \Plm (\costheta) \nonumber \\
&= \alphalm (1 - (\costheta)^2)^\frac{|m|}{2} \eimphi P^{(|m|,|m|)}_{l-|m|}(\costheta), 
\end{align}
where  $0 \le |m| \le l, \, l \in \No$.

\item The SHs are polynomials in $x,y,z$ which we denote $\Ylm(x,y,z)$:
\begin{align}
\Ylm(x,y,z) &= \alphalm (1 - z^2)^\frac{|m|}{2} \eimphi P^{(|m|,|m|)}_{l-|m|}(z), \quad \text{where } 0 \le |m| \le l, \, l \in \No.
\end{align}

\item Span all polynomials modulo the ideal generated by $x^2 + y^2 + z^2 - 1$.

\end{itemize}

}

\frame
{
    \frametitle{Jacobi Operators}

\begin{block}{Goal}
To use SHs as a basis for scalar valued functions on the unit sphere $S := \{ \bold{x} := (x,y,z) \quad | \quad ||\bold{x}|| = 1\} \subset \R^3$.
\end{block} 

\begin{itemize}

\item Computationally work with coefficients of the expansion of a function.

\item Among the basic operators we require are those for multiplication by $x, y$ and $z$.
\begin{align}
x\,\Ylm(x,y,z) &= \Alm Y^{m+1}_{l+1}(x,y,z) +  \Blm Y^{m+1}_{l-1}(x,y,z) \nonumber \\
		     & \quad \quad \quad + \Dlm Y^{m-1}_{l+1}(x,y,z) + \Elm Y^{m-1}_{l-1}(x,y,z), \\ \nonumber \\
y\,\Ylm(x,y,z) &= - i \, \big[\Alm Y^{m+1}_{l+1}(x,y,z) +  \Blm Y^{m+1}_{l-1}(x,y,z) \big] \nonumber \\
		     &\quad \quad \quad + i \, \big[ \Dlm Y^{m-1}_{l+1}(x,y,z) + \Elm Y^{m-1}_{l-1}(x,y,z) \big], \\ \nonumber \\
z\,\Ylm(x,y,z) &= \Flm Y^{m}_{l+1}(x,y,z) + \Glm Y^{m}_{l-1}(x,y,z) ,
\end{align}

\end{itemize}

}

\frame
{
    \frametitle{Jacobi Operators}

Define, for \(l \in \No\), \(\Pl\) as the column vector of the degree \(l\) spherical harmonic polynomials, and \(\bigP\) as the stacked block vector of the \(\Pl\)'s; that is
\begin{align}
\Pl := \begin{bmatrix}
		Y^{-l}_l \\
		\vdots \\
		Y^l_l
	\end{bmatrix} \in \C^{2l+1}, 
\quad \quad 
\bigP := \begin{bmatrix}
		\bigP_0 \\
		\hline
		\bigP_1 \\
		\hline
		\bigP_2 \\
		\vdots \\
	\end{bmatrix}.
\end{align}

Define the (Jacobi) matrices \(J^x, J^y, J^z\) by 
\begin{align}
J^x \bigP = x \bigP, \quad J^y \bigP = y \bigP, \quad J^z \bigP = z \bigP.
\end{align}

}

\frame
{
    \frametitle{Jacobi Operators}
Using eqns (14--16), the Jacobi matrices take the following Banded-Block-Banded form:
\begin{align}
J^x &= \begin{bmatrix}
		B^x_0 & A^x_0 & & & & \\
		C^x_1 & B^x_1 & A^x_1 & & & \\
		& C^x_2 & B^x_2 & A^x_2  & & & \\
		& & C^x_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix},
J^y = \begin{bmatrix}
		B^y_0 & A^y_0 & & & & \\
		C^y_1 & B^y_1 & A^y_1 & & & \\
		& C^y_2 & B^y_2 & A^y_2  & & & \\
		& & C^y_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix}, \nonumber \\
&\quad \quad \quad \quad \quad \quad \quad J^z = \begin{bmatrix}
		B^z_0 & A^z_0 & & & & \\
		C^z_1 & B^z_1 & A^z_1 & & & \\
		& C^z_2 & B^z_2 & A^z_2  & & & \\
		& & C^z_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Three-term recurrence relation}

Define the joint matrices for each \(l \in \No\):
\begin{align}
A_l &:= \begin{bmatrix}
		A^x_l \\
		A^y_l \\
		A^z_l
	    \end{bmatrix} \in \R^{3(2l+1)\times(2l+3)}, \quad
C_l := \begin{bmatrix}
		C^x_l \\
		C^y_l \\
		C^z_l
	    \end{bmatrix} \in \R^{3(2l+1)\times(2l-1)} \quad (l \ne 0), \\
B_l &:= \begin{bmatrix}
		B^x_l \\
		B^y_l \\
		B^z_l
	    \end{bmatrix} \in \R^{3(2l+1)\times(2l+1)}, \quad
G_l(x,y,z) := \begin{bmatrix}
		xI_{2l+1} \\
		yI_{2l+1} \\
		zI_{2l+1}
	    \end{bmatrix} \in \R^{3(2l+1)\times(2l+1)}.
\end{align}
Then our system (62) simply becomes
\begin{align}
\renewcommand\arraystretch{1.3}
\mleft[
\begin{array}{cccc}
		1  & & & \\
		B_0-G_0(x,y,z) & A_0 & & \\
		C_1 & B_1-G_1(x,y,z) & \quad A_1 \quad & \\
		& C_2 & \ddots & \ddots \\
		& & \ddots &
\end{array}
\mright]
\bigP
=
\begin{bmatrix}
	\alpha^0_0 \\ 0 \\ 0 \\ \vdots \\ \\
\end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Three-term recurrence relation}

For each \(l \in \No\) let \(\Dlt\) be any matrix that is a left inverse of \(A_l\), i.e. such that \(\Dlt A_l = I_{2l+3}\). Multiplying our system by the preconditioner matrix that is given by the block diagonal matrix of the \(\Dlt\)'s, we obtain the lower triangular system \citep{dunkl2014orthogonal}
\begin{align}
\renewcommand\arraystretch{1.3}
\mleft[
\begin{array}{cccc}
		1  & & & \\
		D^T_0(B_0-G_0) & I_3 & & \\
		D^T_1 C_1 & D^T_1(B_1-G_1) & \quad I_5 \quad & \\
		& D^T_2 C_2 & \ddots & \ddots \\
		& & \ddots &
\end{array}
\mright]
\bigP
=
\begin{bmatrix}
	\alpha^0_0 \\ 0 \\ 0 \\ \vdots \\ \\
\end{bmatrix}.
\end{align}

Expanding this we can solve the system (66) to find a three-term recurrence relation for each \(\bigP_{l+1}\) in terms of the previous two sub-vectors \(\Pl\) and \(\bigP_{l-1}\):
\begin{align}
\begin{cases}
\bigP_{-1} := 0 \\
\bigP_{0} := \alpha^0_0 \\
\bigP_{l+1} = -\Dlt (B_l-G_l) \Pl - \Dlt C_l  \,\bigP_{l-1}, \quad l \in \N.
\end{cases}
\end{align}

}

\frame
{
    \frametitle{Function Evaluation}
    
We can use the Clenshaw algorithm to evaluate a function at a given point \((x,y,z)\) on the unit sphere provided we know the coefficients of the function when expanded in the spherical harmonic basis, i.e. suppose \(f(x,y,z)\) is a function and we know the set \(\{\bold{f}_l\}\) s.t.
\begin{align}
f(x,y,z) \approx \sum^N_{l=0} \bold{f}_l^T \, \Pl (x,y,z), \quad \text{where } \Pl (x,y,z), \bold{f}_l \in \R^{2l+1} \text{ for each } l \in \{0,\dots,N\}.
\end{align}

The Clenshaw algorithm is then as follows:
\begin{align*}
\quad &\text{1) } \text{Set } \bm{\gamma}_{N+2} = \bold{0}, \: \bm{\gamma}_{N+2} = \bold{0}. \\
\quad &\text{2) } \text{For } n = N:-1:1 \\
\quad & \quad \quad \quad \text{set } \bm{\gamma}_{n}^T = \bold{f}_n^T - \bm{\gamma}_{n+1}^T D^T_n (B_n - G_n) -  \bm{\gamma}_{n+2}^T D^T_{n+1}C_{n+1} \\
\quad &\text{3) } \text{Output: } f(x,y,z) \approx \bigP_0(x,y,z) f_0 + \bm{\gamma}_{1}^T \bigP_1(x,y,z) - \bigP_0(x,y,z) \bm{\gamma}_{2}^T D^T_1 C_1.
\end{align*}

}

\frame
{
    \frametitle{Tangent Space}

\begin{itemize}

\item The gradients and perpendicular gradients of the spherical harmonics \(\gradYlm\) and\(\gradpYlm\) are a basis for the tangent space. Note that the perpendicular gradient is related to the regular surface gradient by
\begin{align}
\gradpYlm(x,y,z) = \unitvec \times \gradYlm(x,y,z),
\end{align}
where \(\unitvec\) is the unit vector normal to the surface of the sphere at the point \((x,y,z)\).

\item \(\gradYlm\), \(\gradpYlm\) are vector-valued orthogonal polynomials, that span all vector-valued polynomials modulo the vanishing ideal $\{ \bm{p} \in (\Pi_3)^3  : \unitvec \cdot \bm{p} = 0 \}$. 

\item A simple calculation shows that such orthogonal polynomials must still have block-tridiagonal Jacobi operators, as multiplication by $x, y$, or $z$ remains inside the ideal. 

\end{itemize}

}

\frame
{
    \frametitle{Vector Spherical Harmonics}
    
\begin{itemize}

\item In general, the tensor spherical harmonic is given by, for \(2l, \, j, \, 2s \in \No\),
\begin{align}
\curlyy^{j,s}_{l,m}(x,y,z) &= \sum_{m_s=-s}^s \langle j \quad m-m_s \; ; \; s \quad m_s \; | \; l \quad m \rangle \: \: Y^{m-m_s}_j (x,y,z) \: \: \bm{\chi}_{s, m_s},
\end{align}

\item \(\bm{\chi}_{s, m_s}\) are the simultaneous eigenstates of the spin operators \(\bold{S}^2\) and \(S_z\).
    
\item \(\langle j \quad m-m_s \; ; \; s \quad m_s \; | \; l \quad m \rangle\) is a Clebsch-Gordan coefficient. 
\begin{itemize}
	\item C-G coefficients vanish unless \(|j - s| \le l \le j + s\). 
	\item There are simple calculable expressions for the C-G coefficients when the spin \(s=1\).
\end{itemize}

\item Both \(\gradYlm\), \(\gradpYlm\) can be expressed in terms of spin-1 tensor spherical harmonics (vector SHs), which in turn can each be expressed as a vector-weighted sum of spherical harmonics.

\end{itemize}

}

\frame
{
    \frametitle{Vector Spherical Harmonics}

To simplify the notation, for spin $s=1$, we define
\begin{align}
\cgcoeff^{L, m_s}_{l, m} := \, \langle L \quad m-m_s \; ; \; 1 \quad m_s \; | \; l \quad m \rangle.
\end{align}

Thus we have that the three spin-1 tensor spherical harmonics are given by
\begin{align}
\curlyy^{l \pm1,s}_{l,m}(x,y,z) &= \sum_{m_s=-1}^1 \cgcoeff^{l\pm1, m_s}_{l, m} \, Y^{m-m_s}_{l \pm 1} (x,y,z) \, \chivec, \\
\curlyy^{l,s}_{l,m}(x,y,z) &= \sum_{m_s=-1}^1 \cgcoeff^{l, m_s}_{l, m} \, Y^{m-m_s}_l (x,y,z) \, \chivec.
\end{align}
where
\begin{align}
\bm{\chi}_{1, \pm 1} = \frac{1}{\sqrt{2}} \begin{bmatrix} \mp 1 \\ -i \\ 0 \end{bmatrix}, \quad \bm{\chi}_{1,0} = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Orthogonal Polynomials on the Tangent Space}

Then, for any \(l \in \No\), \(m \in \Z\) s.t. \(0 \le |m| \le l\) we have that
\begin{align}
\nabla \Ylm &= \blmone \, \curlyy^{l-1,1}_{l,m} + \blone \curlyy^{l+1,1}_{l,m}, \\
\nabla^\perp \Ylm &= \blzero \, \curlyy^{l,1}_{l,m},
\end{align}
where
\begin{align}
\blmone &:= (l+1) \, \Big(\frac{l}{2l+1}\Big)^\half, \quad
\blzero := i \, \big(l(l+1)\big)^\half, \quad
\blone := l \, \Big(\frac{l+1}{2l+1}\Big)^\half.
\end{align}

}

\frame
{
    \frametitle{Jacobi Operators}
    
\begin{block}{Goal}
To use the gradient and perpendicular gradients of the SHs as a basis for vector valued functions in the tangent space on the unit sphere.
\end{block}

\begin{align}
x \,\gradYlm &= \alm \gradY^{m+1}_{l+1} + \blm \gradY^{m+1}_{l-1} + \dlm \gradY^{m-1}_{l+1} + \elm \gradY^{m-1}_{l-1} \nonumber \\
& \quad \quad \quad + \hlm \gradpY^{m+1}_{l} + \jlm \gradpY^{m-1}_{l}, \\
y \,\gradYlm &= i \, \Big[ -\alm \gradY^{m+1}_{l+1} - \blm \gradY^{m+1}_{l-1} + \dlm \gradY^{m-1}_{l+1} + \elm \gradY^{m-1}_{l-1} \nonumber \\
& \quad \quad \quad - \hlm \gradpY^{m+1}_{l} + \jlm \gradpY^{m-1}_{l} \Big], \\
z \,\gradYlm &= \flm \gradY^{m}_{l+1} + \glm \gradY^{m}_{l-1} + \klm \gradpY^{m}_{l},
\end{align}
    
}

\frame
{
    \frametitle{Jacobi Operators}

\begin{align}
x \,\gradpYlm &= \almperp \gradpY^{m+1}_{l+1} + \blmperp \gradpY^{m+1}_{l-1} + \dlmperp \gradpY^{m-1}_{l+1} + \elmperp \gradpY^{m-1}_{l-1} \nonumber \\
& \quad \quad \quad + \hlmperp \gradY^{m+1}_{l} + \jlmperp \gradY^{m-1}_{l}, \\
y \,\gradpYlm &= i \, \Big[ -\almperp \gradpY^{m+1}_{l+1} - \blmperp \gradpY^{m+1}_{l-1} + \dlmperp \gradpY^{m-1}_{l+1} + \elmperp \gradpY^{m-1}_{l-1} \nonumber \\
& \quad \quad \quad - \hlmperp \gradY^{m+1}_{l} + \jlmperp \gradY^{m-1}_{l}, \\
z \,\gradpYlm &= \flmperp \gradpY^{m}_{l+1} + \glmperp \gradpY^{m}_{l-1} + \klmperp \gradY^{m}_{l},
\end{align}
where it can be shown that
\begin{align}
\almperp &= \alm^*, \quad \blmperp = \blm^*, \quad \dlmperp = \dlm^*, \quad \elmperp = \elm^*, \nonumber \\
\flmperp = \flm^*,& \quad \glmperp = \glm^*, \quad \hlmperp = \hlm^*, \quad \jlmperp = \jlm^*, \quad \klmperp = \klm^*,
\end{align}
where \(^*\) denotes the complex conjugate.

}

\frame
{
    \frametitle{Jacobi Operators}

\begin{itemize}

\item Define \(\gradP\) as the block-column vector
\begin{align}
\gradP = \begin{bmatrix} \gradP_0 \\ \gradP_1 \\ \vdots \end{bmatrix}, \quad \text{where } \quad \gradP_l = \begin{bmatrix} \gradY^{-l}_l \\ \gradpY^{-l}_l \\ \vdots \\ \gradY^{l}_l \\ \gradpY^{l}_l  \end{bmatrix} \quad \forall \: l \in \No.
\end{align}

\item Let $S := \{ \bold{x} := (x,y,z) \quad | \quad ||\bold{x}|| = 1\}$ be the unit sphere in $\R^3$.

\item Define
\begin{align}
\bold{u}^c = \begin{bmatrix}
			\bold{u}_0^c \\
			\bold{u}_1^c \\
			\vdots \\
		    \end{bmatrix},		  
\quad
\text{where}
\quad
\bold{u}^c_l &= \begin{bmatrix}
				u_{l,-l} \\
				u^{\perp}_{l,-l} \\
				\vdots \\
				u_{l,l} \\
				u^{\perp}_{l,l}
		        \end{bmatrix} \in \R^{2(2l+1)} \quad \forall l = 0,1,2,\dots
\end{align}

\end{itemize}

}

\frame
{
    \frametitle{Jacobi Operators}

\begin{itemize}

\item Let $\mathbf{u}(x,y,z)$ be a function on $S$ with vector values in the tangent space, i.e. there exist coefficients $\{u_{l,m}, u^\perp_{l,m}\}$ such that, $\forall (x,y,z) \in S$:
\begin{align}
\mathbf{u}(x,y,z) &= \sum_{l=0}^\infty \sum_{m=-l}^l \big( u_{l,m} \gradYlm(x,y,z) + u^\perp_{l,m} \gradpYlm(x,y,z) \big) \\
&= (\mathbf{u}^c)^T \gradP(x,y,z)
\end{align}

\item \(J_\nabla^x\) is defined as the matrix such that 
\begin{align}
x \: \mathbf{u}(x,y,z) = \sum_{l=0}^\infty \sum_{m=-l}^l \big( \tilde{u}_{l,m} \gradYlm(x,y,z) + \tilde{u}^\perp_{l,m} \gradpYlm(x,y,z) \big),
\end{align}
$\forall (x,y,z) \in S$, where
\begin{align}
(J_\nabla^x)^T \mathbf{u}^c = \mathbf{\tilde{u}}^c,
\quad
\bold{\tilde{u}}^c = \begin{bmatrix}
			\bold{\tilde{u}}_0^c \\
			\bold{\tilde{u}}_1^c \\
			\vdots \\
		    \end{bmatrix},		  
\quad
\text{and}
\quad
\bold{\tilde{u}}^c_l &= \begin{bmatrix}
				\tilde{u}_{l,-l} \\
				\tilde{u}^{\perp}_{l,-l} \\
				\vdots \\
				\tilde{u}^{\perp}_{l,l}
		        \end{bmatrix} \quad \forall l = 0,1,2,\dots
\end{align}

\end{itemize}

}

\frame
{
    \frametitle{Jacobi Operators}
    
\begin{itemize}

\item In other words, abusing notation, we can write that
\begin{align}
J_\nabla^x \gradP = x \gradP
\end{align}
where each sub-vector entry \(\gradYlm\) and \(\gradpYlm\) of \(\gradP\) is treated as a single element of the vector \(\gradP\) in the matrix-vector calculation.

\item \(J_\nabla^y, J_\nabla^z\) are defined similarly.

\end{itemize}

}

\frame
{
    \frametitle{Jacobi Operators}
    
Using eqns (36--41), the Jacobi matrices take the similar Banded-Block-Banded form:
\begin{align}
J_\nabla^x &= \begin{bmatrix}
		B^x_0 & A^x_0 & & & & \\
		C^x_1 & B^x_1 & A^x_1 & & & \\
		& C^x_2 & B^x_2 & A^x_2  & & & \\
		& & C^x_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix},
J_\nabla^y = \begin{bmatrix}
		B^y_0 & A^y_0 & & & & \\
		C^y_1 & B^y_1 & A^y_1 & & & \\
		& C^y_2 & B^y_2 & A^y_2  & & & \\
		& & C^y_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix}, \nonumber \\
&\quad \quad \quad \quad \quad \quad \quad J_\nabla^z = \begin{bmatrix}
		B^z_0 & A^z_0 & & & & \\
		C^z_1 & B^z_1 & A^z_1 & & & \\
		& C^z_2 & B^z_2 & A^z_2  & & & \\
		& & C^z_3 & \ddots & \ddots & \\
		& & & \ddots & \ddots & \ddots \\
	\end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Three-term recurrence relation}

For each \(l \in \N\) define the joint matrices:
\begin{align}
A_l &:= \begin{bmatrix}
		A^x_l \\
		A^y_l \\
		A^z_l
	    \end{bmatrix} \in \R^{6(2l+1)\times2(2l+3)}, \quad
C_l := \begin{bmatrix}
		C^x_l \\
		C^y_l \\
		C^z_l
	    \end{bmatrix} \in \R^{6(2l+1)\times2(2l-1)} \quad (l \ne 1), \\
B_l &:= \begin{bmatrix}
		B^x_l \\
		B^y_l \\
		B^z_l
	    \end{bmatrix} \in \R^{6(2l+1)\times2(2l+1)}, \quad
G_l(x,y,z) := \begin{bmatrix}
		xI_{2(2l+1)} \\
		yI_{2(2l+1)} \\
		zI_{2(2l+1)}
	    \end{bmatrix} \in \R^{6(2l+1)\times2(2l+1)}.
\end{align}
Then our system becomes
\begin{align}
\renewcommand\arraystretch{1.3}
\mleft[
\begin{array}{cccc}
		I_2 \\
		0 & I_6 & & \\
		C_1 & B_1-G_1 & A_1 \quad & \\
		& C_2 & \ddots & \ddots \\
		& & \ddots &
\end{array}
\mright]
\gradP
=
\begin{bmatrix}
	\underline{0}_3 \\ \underline{0}_3 \\ \gradP_1 \\ \underline{0}_3 \\ \\ \vdots \\
\end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Three-term recurrence relation}

In a similar way as for the scalar case, for each \(l \in \N\) let \(\Dlt\) be any matrix that is a left inverse of \(A_l\), i.e. such that \(\Dlt A_l = I_{2(2l+3)}\). We can then obtain the lower triangular system
\begin{align}
\renewcommand\arraystretch{1.3}
\mleft[
\begin{array}{cccc}
		I_2 \\
		0 & I_6 & & \\
		D^T_1 C_1 & D^T_1(B_1-G_1) & \quad I_{10} \quad & \\
		& D^T_2 C_2 & \ddots & \ddots \\
		& & \ddots &
\end{array}
\mright]
\gradP
=
\begin{bmatrix}
	\underline{0}_3 \\ \underline{0}_3 \\ \gradP_1 \\ \underline{0}_3 \\ \\ \vdots \\
\end{bmatrix}.
\end{align}

}

\frame
{
    \frametitle{Three-term recurrence relation}

Expanding this we can find a three-term recurrence relation for each \(\gradP_{l+1}\) in terms of the previous two sub-vectors \(\gradPl\) and \(\gradP_{l-1}\):
\begin{align}
\begin{cases}
\gradP_{0}(x,y,z) := \underline{0}_6 \\
\\
\gradP_{1}(x,y,z) := \begin{bmatrix}
				\gradY_1^{-1}(x,y,z) \\ \gradpY_1^{-1}(x,y,z) \\ \gradY_1^{0}(x,y,z) \\ \gradpY_1^{0}(x,y,z) \\ \gradY_1^{1}(x,y,z) \\ \gradpY_1^{1}(x,y,z) \\
			\end{bmatrix} \\
\\
\gradP_{l+1}(x,y,z) = -\Dlt [B_l-G_l(x,y,z)] \gradPl(x,y,z) - \Dlt C_l  \,\gradP_{l-1}(x,y,z).
\end{cases}
\end{align}
}

\frame
{
    \frametitle{Function Evaluation}
    
We can use the Clenshaw algorithm again to evaluate a vector valued function in the tangent space at a point $(x,y,z) \in S$. Suppose
\begin{align}
\mathbf{u}(x,y,z) \approx \sum^N_{l=0} \sum^l_{m=-l} \big[u_{l,m} \, \gradYlm(x,y,z)  + u^\perp_{l,m} \, \gradpYlm(x,y,z) \big].
\end{align}

The Clenshaw algorithm is then as follows:
\begin{align*}
\quad &\text{1) } \text{Set } \bm{\gamma}_{N+2} = \bold{0}, \: \bm{\gamma}_{N+2} = \bold{0}. \\
\quad &\text{2) } \text{For } n = N:-1:1 \\
\quad & \quad \quad \quad \text{set } \bm{\gamma}_{n}^T = (\mathbf{u}^c_n)^T - \bm{\gamma}_{n+1}^T D^T_n (B_n - G_n) -  \bm{\gamma}_{n+2}^T D^T_{n+1}C_{n+1} \\
\quad &\text{3) } \text{Output: } \mathbf{u}(x,y,z) \approx \bm{\gamma}_{1}^T \gradP_1(x,y,z)
\end{align*}

}

\frame
{
    \frametitle{How does this work practically?}

\begin{itemize}

\item \(S := \{ \bold{x} := (x,y,z) \quad | \quad ||\bold{x}|| = 1\}\) be the unit sphere in \(\R^3\)

\item \(\bold{u}(x,y,z)\), \(\bold{v}(x,y,z)\) vector valued functions for \((x,y,z)\) on the unit sphere with values in the tangent space 

\item \(h(x,y,z)\) scalar function on the sphere.

\end{itemize}

\begin{align}
\implies \bold{u} &= \sum_{l=0}^{\infty} \sum_{m=-l}^{l} [ u_{l,m} \gradYlm + u^{\perp}_{l,m} \gradpYlm ], \\
\bold{v} &= \sum_{l=0}^{\infty} \sum_{m=-l}^{l} [ v_{l,m} \gradYlm + v^{\perp}_{l,m} \gradpYlm ], \\
h &= \sum_{l=0}^{\infty} \sum_{m=-l}^{l} h_{l,m} \Ylm,
\end{align}
for some real coefficients \(u_{l,m}, u^{\perp}_{l,m}, v_{l,m}, v^{\perp}_{l,m}, h_{l,m}\). 

}

\frame
{
    \frametitle{How does this work practically?}

Define the vectors of these coefficients as 
\begin{align}
\bold{u}^c &= \begin{bmatrix}
			\bold{u}_0^c \\
			\bold{u}_1^c \\
			\vdots \\
		    \end{bmatrix},
\quad
\bold{v}^c = \begin{bmatrix}
			\bold{v}_0^c \\
			\bold{v}_1^c \\
			\vdots \\
		    \end{bmatrix},
\quad
\bold{h}^c = \begin{bmatrix}
			\bold{h}_0^c \\
			\bold{h}_1^c \\
			\vdots \\
		    \end{bmatrix},		  
\end{align}
where
\begin{align}
\bold{u}^c_l &= \begin{bmatrix}
				u_{l,-l} \\
				u^{\perp}_{l,-l} \\
				\vdots \\
				u_{l,l} \\
				u^{\perp}_{l,l}
		        \end{bmatrix},
\quad
\bold{v}^c_l = \begin{bmatrix}
				v_{l,-l} \\
				v^{\perp}_{l,-l} \\
				\vdots \\
				v_{l,l} \\
				v^{\perp}_{l,l}
		        \end{bmatrix},
\quad
\bold{h}^c_l = \begin{bmatrix}
				h_{l,-l} \\
				\vdots \\
				h_{l,l} \\
		        \end{bmatrix},
\quad \forall l \in \No	  
\end{align}.

}

\frame
{
    \frametitle{How does this work practically?}

For large enough \(N \in \N\) we have that
\begin{align}
\bold{u} &\approx \sum_{l=0}^{N} \sum_{m=-l}^{l} [ u_{l,m} \gradYlm + u^{\perp}_{l,m} \gradpYlm ], \\
\bold{v} &\approx \sum_{l=0}^{N} \sum_{m=-l}^{l} [ v_{l,m} \gradYlm + v^{\perp}_{l,m} \gradpYlm ], \\
h &\approx \sum_{l=0}^{N} \sum_{m=-l}^{l} h_{l,m} \Ylm,
\end{align}
and so we define the truncated coefficient vectors for some \(N \in \N\) as
\begin{align}
\bold{u}^c &= \begin{bmatrix}
			\bold{u}_0^c \\
			\bold{u}_1^c \\
			\vdots \\
			\bold{u}_N^c
		    \end{bmatrix},
\quad
\bold{v}^c = \begin{bmatrix}
			\bold{v}_0^c \\
			\bold{v}_1^c \\
			\vdots \\
			\bold{v}_N^c
		    \end{bmatrix},
\quad
\bold{h}^c = \begin{bmatrix}
			\bold{h}_0^c \\
			\bold{h}_1^c \\
			\vdots \\
			\bold{h}_N^c
		    \end{bmatrix}.		  
\end{align}

}

\frame
{
    \frametitle{How does this work practically?}
 
Operators act on the coefficients vectors.

Easily derive operators for Grad, Div, curl with the unit vector, etc. as well as the multiplications by $x, y, z$.

- BandedBlockBanded structures

Can calculate dot products simply.
    
}

\frame
{
    \frametitle{Example: Linearised SWE}

Operators:

$K$ - cross product with $\unitvec$

$F$ - Coriolis parameter

$D$ - Divergence operator (of a function in the tangent space)

$G$ - Gradient operator (of a scalar function)

Let $\mathbf{u}(x,y,z)$ be the tangential velocity of the flow and $h(x,y,z)$ be the height of the water from some constant reference height $\mathcal{H}$.

The linear SWEs are
\begin{align}
\begin{cases}
\frac{\partial \mathbf{u}}{\partial t} + f \unitvec \times \mathbf{u} - \nabla h = \mathbf{0} \\
\frac{\partial h}{\partial t} + \mathcal{H} \nabla \cdot \mathbf{u} = 0
\end{cases}
\end{align}
where $f = 2 \Omega \cos(\theta) =  2 \Omega z$ is the Coriolis parameter.
   
}

\frame
{
    \frametitle{Example: Linearised SWE}

Using backward Euler:
\begin{align}
\mathbf{u}_{n+1} &= \mathbf{u}_{n} + \Delta t \: (\nabla h_{n+1} - f \unitvec \times \mathbf{u}_{n+1}) \\
h_{n+1} &= h_n - \Delta t \: \mathcal{H} \nabla \cdot \mathbf{u}_{n+1}
\end{align}

Then using the operators on the coefficient vectors, the timestepping method is: 
\begin{align}
\mathbf{u}^c_{n+1} &= \mathbf{u}^c_{n} + \Delta t \: (G \mathbf{h}^c_{n+1} - F K \mathbf{u}^c_{n+1}) \\
\mathbf{h}^c_{n+1} &= \mathbf{h}^c_n - \Delta t \: \mathcal{H} D \mathbf{u}^c_{n+1}
\end{align}
$\iff$
\begin{align}
\mathbf{u}^c_{n+1} &= (I + \Delta t F K + \Delta t^2 \mathcal{H} G D)^{-1} \: (\mathbf{u}^c_{n} + \Delta t \: G \mathbf{h}^c_n) \\
\mathbf{h}^c_{n+1} &= \mathbf{h}^c_n - \Delta t \: \mathcal{H} D \mathbf{u}^c_{n+1}
\end{align}
   
}

\frame
{
    \frametitle{Example: Linearised SWE}

\includemedia[
     width=6cm,height=6cm,
     activate=pageopen,
     addresource=swe.avi,
     flashvars={
         source=swe.avi
        &autoPlay=false
     }
]{}{VPlayer.swf}

}

\frame
{
    \frametitle{Where next?}

\begin{itemize}

\item Future work will focus on using similar techniques for a suitable basis of OPs on spherical triangles.

\item First, we are looking at the 2D analog - the circle arc

\begin{itemize}
	\item Used a version of the Lanczos algorithm to determine OPs
	\item Implemented function evaluation
	\item Operator for derivative along the arc segment
\end{itemize}

\end{itemize}
   
}

\frame
{
    \frametitle{Summary}

  \begin{itemize}
  
  \item The motivation was to look at creating a library for working with SHs as OPs in three variables on the sphere.
 
  \item Derived operators for multiplication by $x, y, z$ for functions expanded in either the scalar or tangent basis.
  
  \item Clenshaw's algorithm can be used to evaluate functions.
  
  \item Example to demonstrate how the operator matrices for common operations can be implemented in a simple timestepping method.
  
  \item Operators are BandedBlockBanded.
  
  \item Look ahead to using similar ideas for a suitable basis of OPs on spherical triangles (3D) by first working on the circle arc (2D).
  
  \end{itemize}
   
}










\frame
{
  \frametitle{References}
\bibliography{spherical-harmonics-bib}
}


\end{document}
